{% extends "base.html" %}
{% block content %}

<div class="page-header">
  <div>
    <h1 class="page-title">概要</h1>
    <p class="page-desc">サーバー状況と直近の統計です。</p>
  </div>
</div>

<div class="glass-card">
  <div class="form-grid">
    <div class="field half">
      <div style="font-weight:900;">合計メンバー</div>
      <div style="font-size:28px; font-weight:900; margin-top:6px;">{{ guild.member_count }}</div>
    </div>
    <div class="field half">
      <div style="font-weight:900;">今日のメッセージ</div>
      <div style="font-size:28px; font-weight:900; margin-top:6px;">{{ stats.messages[-1] if stats.messages else 0 }}</div>
    </div>
  </div>
</div>

<div class="glass-card chart-card">
  <div style="font-weight:900; margin-bottom:10px;">メッセージ送信履歴（7日）</div>
  <div class="chart-wrap">
    <canvas id="msgChart"></canvas>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('msgChart').getContext('2d');
new Chart(ctx, {
  type: 'line',
  data: {
    labels: {{ stats.dates | tojson }},
    datasets: [{
      label: 'Messages',
      data: {{ stats.messages | tojson }},
      fill: true,
      tension: 0.35
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: { legend: { display: false } },
    scales: {
      y: { beginAtZero: true }
    }
  }
});
</script>

{% endblock %}
